<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Unicode: Unicode dynamic lib for scripting language support of high speed lexing</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Unicode
   </div>
   <div id="projectbrief">Dynamic Library for Unicode Support Functions</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Unicode dynamic lib for scripting language support of high speed lexing </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This C language optimized library offers a set of functions designed to enable development of DSL lexing/parsing at very high performance while being as high quality as is reasonable without obfuscating what is done and why the implementation works.</p>
<p>The principle insight is that GOTO and table-driven transforms outperform architectures which test for values and take alternate code paths. GOTO and table-driven are considered unusual for modern development.</p>
<p>The code is designed to be very short and tight. It makes use of the gnu compiler stack where computed GOTO has been a standard extension for many years, where other compilers have no support for this efficiency.</p>
<p>A benefit of the use of GOTO in this library is that the likely code path has been prefetched into the processor cache (so there is no flushing of the cache for either of the two directions the GOTO may take).</p>
<p>The general approach to table-driven paths is explained in the main README.md which is in the parent directory to this library source.</p>
<p>This directory will be the primary area for development of a shared Python library because CFFI is less friendly to C++ than it is to C function entrypoints.</p>
<p>valgrind does not identify any memory leaks resulting from the code in this library There are memory leaks in the test modules due to implementation errors in the standard library.</p>
<h2>Dependency graph</h2>
<div class="image">
<img src="Makefile.png"  alt="Dependency Graph"/>
</div>
<h2>Points of Interest</h2>
<h3>UTF8 &lt;-&gt; char32_t</h3>
<p>Python libraries for handling UTF8 and full-width Unicode codepoints are fraught with pitfalls for the everyday developer. This library offers a simple pair of symmetric operations which convert between UTF8 encoded strings (the default most popular Unicode format) and string32 (the necessary ordinal size for internal Unicode).</p>
<p>Were this implementation not available, here are issues to consider:</p><ul>
<li>Recompile Python to handle 21 bit codepoints rather than only 16 bit</li>
<li>Import libraries for which the encode/decode interface is richer</li>
<li>Run additional tests to guarantee that the imports perform fully</li>
<li>Additional concerns not listed here...</li>
</ul>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# Here is all that will be needed to use these library functions:</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;with open(&quot;UTF8encoded_source.txt&quot;, &quot;rb&quot;) as source:</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    asUTF8 = source.read()</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    UTF8_to_u32string(asUTF8, asU32String)</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;# asU32String is an array of 32 bit codepoints.</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;with open(&quot;UTF8encoded_target.txt&quot;, &quot;wb&quot;) as target:</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    u32string_to_UTF8(asU32String, asUTF8)</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    target.write(asUTF8)</div></div><!-- fragment --><h3>Generate refactored Classify.c <a class="el" href="_classify_8h_source.html">Classify.h</a></h3>
<p>These files are now generated from DerivedGeneralCategory.txt by gen_Classify.py.</p>
<h2>TODO</h2>
<ul>
<li>Improve unit testing</li>
<li>Clarify typedefs in <a class="el" href="_unicode_8h_source.html">Unicode.h</a></li>
<li>Find a worthy gprof for Mac OS X</li>
<li>Continue port to linux</li>
<li>Eliminate warnings on linux</li>
</ul>
<h3>TODO Unicode.c</h3>
<ul>
<li>Improve Tests of UTF8 &lt;-&gt; char32 transforms in test_Unicode.c</li>
</ul>
<h3>TODO gcov</h3>
<ul>
<li>Improve coverage </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
